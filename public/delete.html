<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Delete Recipe</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <nav>
      <a href="/index.html">Home</a> |
      <a href="/view.html">View recipes</a> |
      <a href="/create.html">Post recipe</a> |
      <a href="/edit.html">Edit recipe</a> |
      <a href="/delete.html">Delete recipe</a>
    </nav>

    <h1>Delete Recipe</h1>

    <p>Enter recipe id to delete:</p>
    <p><input id="id" placeholder="Recipe id"></p>
    <div class="actions">
      <button id="del" type="button">Delete</button>
    </div>

    <pre id="out">Waitingâ€¦</pre>

    <script src="/config.js"></script>
    <script>
      const out = document.getElementById("out");
      const show = (x) => out.textContent = typeof x === "string" ? x : JSON.stringify(x, null, 2);

      function deleteUrl(id) {
        return `${window.API_BASE}/recipeService?id=${encodeURIComponent(id)}`;
      }

      document.getElementById("del").addEventListener("click", async () => {
        const id = document.getElementById("id").value.trim();
        if (!id) return show("Enter an id.");

        const url = deleteUrl(id);

        try {
          const resp = await fetch(url, { method: "DELETE" });
          if (resp.status === 204) return show({ success: true, deletedId: id });

          const text = await resp.text();
          let body; try { body = JSON.parse(text); } catch { body = text; }
          show({ error: "delete failed", status: resp.status, body, url });
        } catch (e) {
          show({ error: "network error", message: String(e), url });
        }
      });
    </script>
  </div>
</body>
</html>
